<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Thank You</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(135deg,#7eb3c4 0%,#9cc9d4 100%);min-height:100vh;display:flex;align-items:center;justify-content:center;color:#0f172a;padding:24px}
    .card{background:rgba(255,255,255,0.2);backdrop-filter:blur(14px);border-radius:20px;padding:32px 28px;max-width:520px;width:100%;box-shadow:0 20px 50px rgba(0,0,0,0.15);border:1px solid rgba(255,255,255,0.35);text-align:center}
    h1{font-size:32px;font-weight:900;margin-bottom:12px;letter-spacing:-0.5px}
    p{font-size:16px;line-height:1.6;color:#0f172a;margin-bottom:20px}
    .pill{display:inline-block;padding:10px 16px;border-radius:999px;background:rgba(255,255,255,0.85);color:#0f172a;font-weight:800;font-size:13px;border:1px solid rgba(15,23,42,0.08);margin-bottom:16px}
    .btn{display:inline-block;margin-top:6px;padding:14px 18px;border-radius:12px;border:none;font-weight:800;cursor:pointer;transition:transform 0.15s,box-shadow 0.15s;text-decoration:none;color:#fff;background:#0f172a;box-shadow:0 12px 26px rgba(0,0,0,0.18);margin:8px}
    .btn:hover{transform:translateY(-2px)}
    .btn-container{display:flex;flex-direction:column;gap:12px;margin-top:24px}
    .btn-secondary{background:#06B6D4}
    .btn-secondary:hover{background:#0891b2}
    .data-section{margin-top:24px;padding-top:24px;border-top:1px solid rgba(15,23,42,0.1);text-align:left;display:none}
    .data-section.show{display:block}
    .data-preview{background:rgba(0,0,0,0.05);border-radius:8px;padding:12px;margin-top:12px;font-size:12px;color:#0f172a;max-height:200px;overflow-y:auto;text-align:left;font-family:monospace;word-break:break-word}
    .success-msg{color:#06D6A0;font-weight:700;margin-top:12px;display:none}
    .error-msg{color:#EF476F;font-weight:700;margin-top:12px;display:none}
  </style>
</head>
<body>
  <div class="card">
    <div class="pill">Thank you!</div>
    <h1>Your site is queued</h1>
    <p id="status">Your website will be generated in the container app. Check it out.</p>
    
    <div class="btn-container">
      <a class="btn" href="home_page.html">Back to Home</a>
      <button class="btn btn-secondary" onclick="viewData()">üìã View Your Data</button>
      <button class="btn btn-secondary" onclick="downloadJSON()">‚¨áÔ∏è Download JSON</button>
    </div>

    <div id="dataSection" class="data-section">
      <h3 style="margin-bottom:12px">Your Site Configuration</h3>
      <div class="data-preview" id="dataPreview"></div>
      <div class="success-msg" id="successMsg"></div>
      <div class="error-msg" id="errorMsg"></div>
    </div>
  </div>

  <script>
    const msg = sessionStorage.getItem('siteStatusMessage');
    if (msg) {
      document.getElementById('status').textContent = msg;
    }

    // Function to collect all user data from sessionStorage
    function collectUserData() {
      const userProfile = JSON.parse(sessionStorage.getItem('userProfile') || '{}');
      const selectedPalette = JSON.parse(sessionStorage.getItem('selectedPalette') || '{}');
      const logo = sessionStorage.getItem('generatedLogo') || sessionStorage.getItem('uploadedLogo');
      const appName = sessionStorage.getItem('appName') || '';
      const catalog = sessionStorage.getItem('selectedCatalog') || 'modern';
      const productPage = sessionStorage.getItem('selectedProductPage') || 'grid';

      return {
        timestamp: new Date().toISOString(),
        siteStatus: 'confirmed',
        profile: {
          firstName: userProfile.firstName || '',
          lastName: userProfile.lastName || '',
          businessName: userProfile.businessName || '',
          phone: userProfile.phone || ''
        },
        website: {
          appName: appName,
          catalog: catalog,
          productLayout: productPage
        },
        branding: {
          palette: {
            name: selectedPalette.name || 'Custom',
            description: selectedPalette.description || '',
            colors: selectedPalette.colors || []
          },
          logo: logo ? '(Logo data included - base64 encoded)' : 'Not provided'
        },
        logoData: logo || null
      };
    }

    // View data in a preview section
    function viewData() {
      const data = collectUserData();
      const dataSection = document.getElementById('dataSection');
      const dataPreview = document.getElementById('dataPreview');
      
      // Remove logo data for display purposes
      const displayData = {...data};
      displayData.logoData = displayData.logoData ? '(Base64 image data - ' + Math.round(displayData.logoData.length / 1024) + 'KB)' : null;
      
      dataPreview.textContent = JSON.stringify(displayData, null, 2);
      dataSection.classList.add('show');
    }

    // Download JSON file
    function downloadJSON() {
      const data = collectUserData();
      const jsonString = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonString], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `site-config-${new Date().getTime()}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      
      showMessage('‚úì JSON file downloaded successfully!', 'success');
    }

    // Send data to backend
    // (Backend developer will implement this)
    // function sendToBackend() {
    //   ...
    // }

    // Helper function to show messages
    function showMessage(msg, type) {
      const successMsg = document.getElementById('successMsg');
      const errorMsg = document.getElementById('errorMsg');
      
      if (type === 'success') {
        successMsg.textContent = msg;
        successMsg.style.display = 'block';
        errorMsg.style.display = 'none';
        setTimeout(() => {
          successMsg.style.display = 'none';
        }, 4000);
      } else {
        errorMsg.textContent = msg;
        errorMsg.style.display = 'block';
        successMsg.style.display = 'none';
      }
    }
  </script>
</body>
</html>
